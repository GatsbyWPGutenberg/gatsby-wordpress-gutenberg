!function(e){var t={};function r(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,r),c.l=!0,c.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(n,c,function(t){return e[t]}.bind(null,c));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=13)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t,r){var n=r(10),c=r(11),o=r(12);e.exports=function(e,t){return n(e)||c(e,t)||o()}},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}e.exports=r},function(e,t){!function(){e.exports=this.wp.hooks}()},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){!function(){e.exports=this.wp.data}()},function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,c=!1,o=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){c=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(c)throw o}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,r){"use strict";r.r(t);var n=r(4),c=r.n(n),o=r(1),u=r.n(o),i=r(6),a=r.n(i),l=r(0),s=r(3),b=r(7),f=r(5),p=r(2),g=r(8),y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),d=new Uint8Array(16);function O(){if(!y)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(d)}for(var j=[],m=0;m<256;++m)j.push((m+256).toString(16).substr(1));var v=function(e,t){var r=t||0,n=j;return(n[e[r+0]]+n[e[r+1]]+n[e[r+2]]+n[e[r+3]]+"-"+n[e[r+4]]+n[e[r+5]]+"-"+n[e[r+6]]+n[e[r+7]]+"-"+n[e[r+8]]+n[e[r+9]]+"-"+n[e[r+10]]+n[e[r+11]]+n[e[r+12]]+n[e[r+13]]+n[e[r+14]]+n[e[r+15]]).toLowerCase()};var w=function(e,t,r){"string"==typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||O)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){for(var c=r||0,o=0;o<16;++o)t[c+o]=n[o];return t}return v(n)},h=function(e){var t=e.active;return Object(l.createElement)(p.Icon,{icon:Object(l.createElement)("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},Object(l.createElement)("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Object(l.createElement)("g",{id:"gatsbyjs-icon",fillRule:"nonzero"},Object(l.createElement)("path",{d:"M17.8571875,10 L12.8571875,10 L12.8571875,11.428125 L16.2853125,11.428125 C15.7853125,13.5709375 14.2134375,15.35625 12.1425,16.0709375 L3.928125,7.8571875 C4.7853125,5.3571875 7.21375,3.5715625 10,3.5715625 C12.1428125,3.5715625 14.071875,4.6434375 15.285625,6.2859375 L16.3575,5.3578125 C14.928125,3.428125 12.6428125,2.1428125 10,2.1428125 C6.285625,2.1428125 3.1428125,4.785625 2.3571875,8.285625 L11.7853125,17.71375 C15.2134375,16.8565625 17.8571875,13.71375 17.8571875,9.999375 L17.8571875,10 Z M2.1428125,10.071875 C2.1428125,12.071875 2.9284375,14 4.4284375,15.5 C5.9284375,17 7.9284375,17.785625 9.8565625,17.785625 L2.1428125,10.071875 Z",id:"Shape",fill:"#FFFFFF"}),Object(l.createElement)("path",{d:"M10,0 C4.5,0 0,4.5 0,10 C0,15.5 4.5,20 10,20 C15.5,20 20,15.5 20,10 C20,4.5 15.5,0 10,0 Z M4.428125,15.571875 C2.928125,14.071875 2.1425,12.071875 2.1425,10.14375 L9.928125,17.8571875 C7.928125,17.7853125 5.928125,17.0715625 4.428125,15.5715625 L4.428125,15.571875 Z M11.71375,17.64375 L2.3571875,8.285625 C3.1428125,4.785625 6.285625,2.1428125 10,2.1428125 C12.6428125,2.1428125 14.928125,3.4284375 16.3571875,5.3571875 L15.2853125,6.2853125 C14.071875,4.6428125 12.1428125,3.571875 10,3.571875 C7.214375,3.571875 4.8571875,5.3575 3.928125,7.8575 L12.1428125,16.071875 C14.2146875,15.3575 15.785625,13.571875 16.285625,11.4290625 L12.8575,11.4290625 L12.8575,10 L17.8575,10 C17.8575,13.714375 15.2146875,16.8571875 11.7146875,17.6428125 L11.71375,17.64375 Z",id:"Shape",fill:t?"#663399":"#555d66"}))))})},E=r(9),C=r.n(E),P=function(e){var t=e.style,r=e.message;return Object(l.createElement)("div",{className:"wp-block-embed is-loading",style:t},Object(l.createElement)(p.Spinner,null),Object(l.createElement)("p",null,r))},S=function(e){var t=e.style,r=e.retry,n=e.message;return Object(l.createElement)("div",{className:"wp-block-embed is-loading",style:t},Object(l.createElement)("p",null,n),Object(l.createElement)(p.Button,{isLarge:!0,isPrimary:!0,onClick:r},Object(s.__)("Retry")))},x=function(e){var t=e.src,r=e.style,n=Object(l.useState)(!1),c=u()(n,2),o=c[0],i=c[1],a=Object(l.useRef)(null),b=Object(l.useRef)(null),f=Object(l.useRef)(!0),p=Object(l.useCallback)((function(){b.current&&(clearTimeout(b.current),b.current=null)}),[b]),g=Object(l.useCallback)((function(){p();var e=fetch(t).then((function(t){if(a.current===e){if(!t||!t.headers.get("X-Theme-Wordpress-Gutenberg-Preview-Page"))return Promise.reject(new Error);i(!0)}})).catch((function(){a.current===e&&(b.current=setTimeout((function(){f.current&&g()}),1500))}));return a.current=e,e}),[t,f]);return Object(l.useEffect)((function(){return g(),function(){f.current=!1,p()}}),[]),o?Object(l.createElement)("iframe",{title:"gatsby-preview",style:r,src:t}):Object(l.createElement)(P,{style:r,message:Object(s.__)("Waiting for Gatsby to create preview page","wp-gatsby-gutenberg")})},k=function(e){var t=e.loading,r=e.error,n=e.data,o=e.minHeight,i=e.previewUUID,a=e.retry,b=Object(l.useState)(null),f=u()(b,2),p=f[0],g=f[1];return Object(l.useEffect)((function(){if(n&&n.gatsby_preview_url){var e=new URL(n.gatsby_preview_url),t=new URLSearchParams(e.search);t.set("previewUUID",i),t.set("timestamp",(new Date).getTime()),e.search=t,g(e.href)}}),[n,i]),t?Object(l.createElement)(P,{style:{minHeight:o},message:Object(s.__)("Triggering preview hook","wp-gatsby-gutenberg")}):r?Object(l.createElement)(S,c()({},r,{retry:a,style:{minHeight:o}})):p?Object(l.createElement)(x,{src:p,style:{minHeight:o}}):null};function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _=Object(l.createContext)(null);Object(f.addFilter)("blocks.registerBlockType","wpGraphqlGutenberg.registerBlockType",(function(e){return U({},e,{attributes:U({},e.attributes,{wpGatsbyGutenbergUUID:{type:"string"}})})})),Object(f.addFilter)("blocks.getBlockAttributes","wpGraphqlGutenberg.getBlockAttributes",(function(e){return e.wpGatsbyGutenbergUUID||(e.wpGatsbyGutenbergUUID=w()),e})),Object(f.addFilter)("editor.BlockEdit","plugin-wp-gatsby-gutenberg-preview/BlockEdit",(function(e){return function(t){var r=t.attributes,n=t.setAttributes;Object(l.useEffect)((function(){r.wpGatsbyGutenbergUUID||n({wpGatsbyGutenbergUUID:w()})}),[r]);var o=window.wpGatsbyGutenberg&&window.wpGatsbyGutenberg.settings.enable_live_preview,i=Object(l.useState)(0),a=u()(i,2),f=a[0],y=a[1],d=Object(l.useState)(!1),O=u()(d,2),j=O[0],m=O[1],v=Object(l.useContext)(_),E=Object(b.useSelect)((function(e){return e("core/editor").getCurrentPostId()}),[]),P=v&&v.attributes.ref&&parseInt(v.attributes.ref,10)||null,S=function(e){var t=e.postId,r=e.attributes,n=e.previewPostId,c=e.refresh,o=Object(l.useState)(!1),i=u()(o,2),a=i[0],s=i[1],b=Object(l.useState)(null),f=u()(b,2),p=f[0],g=f[1],y=Object(l.useState)(null),d=u()(y,2),O=d[0],j=d[1],m=Object(l.useRef)(null),v=Object(l.useRef)(null),w=Object(l.useRef)(null),h=Object(l.useCallback)((function(){s(!0),g(null);var e=C()({path:"/wp-gatsby-gutenberg/v1/previews/refresh",method:"POST",data:{postId:t,previewPostId:n}}).then((function(t){e===m.current&&j(t)})).catch((function(t){e===m.current&&g(t)})).finally((function(){e===m.current&&s(!1)}));return m.current=e,e}),[t,n,r,m]);return Object(l.useEffect)((function(){c&&(v.current!==h||!1===w.current&&p)&&(v.current=h,h()),w.current=c}),[c,h]),{loading:a,data:O,error:p,retry:h,previewUUID:r.wpGatsbyGutenbergUUID}}(U({},t,{refresh:j,postId:P||E,previewPostId:E}));return"core/block"===t.name?Object(l.createElement)(_.Provider,{value:t},Object(l.createElement)(e,t)):o?Object(l.createElement)(l.Fragment,null,j?Object(l.createElement)(k,c()({minHeight:f},S)):Object(l.createElement)(e,t),Object(l.createElement)(g.BlockControls,null,Object(l.createElement)(p.Toolbar,null,Object(l.createElement)(p.Button,{className:"components-toolbar__control",label:Object(s.__)("Gatsby Preview"),onClick:function(){if(!j){var e=document.querySelector('div[data-block="'.concat(t.clientId,'"]'));e&&y(e.clientHeight)}m(!j)}},Object(l.createElement)(h,{active:j}))))):Object(l.createElement)(e,t)}}))}]);